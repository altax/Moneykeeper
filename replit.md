# Копилка - Приложение для накоплений (v3 Redesign)

## Обзор
Мобильное приложение для Android/iOS, разработанное на React Native (Expo), которое помогает пользователю копить деньги на финансовые цели.

## Текущее состояние
- Полный редизайн UI: светлая "calm neo-mint" тема с поддержкой тёмного режима
- Упрощённая навигация: 3 вкладки (Главная, Цели, Профиль)
- Модальный поток для работы со сменами
- Локальное хранение данных через AsyncStorage

## Основной функционал
- Создание и редактирование финансовых целей с иконками
- Визуальный прогресс накоплений (круговая диаграмма, прогресс-бар)
- Быстрое пополнение целей (кнопки 500/1000/остаток)
- Авто-перенос излишков в сейф при превышении цели
- Отслеживание рабочих смен (планирование, завершение, история)
- Сейф для хранения и распределения излишков
- Профиль с настройками и средним заработком для расчёта дней

## Технологии
- React Native с Expo SDK 54
- React Navigation 7 для навигации
- AsyncStorage для локального хранения
- react-native-svg для визуализации прогресса
- react-native-reanimated для анимаций
- MaterialCommunityIcons для иконок

## Структура проекта
```
client/
├── components/        # UI компоненты
│   ├── ThemedView.tsx       # Контейнер с темой
│   ├── ThemedText.tsx       # Текст с темой
│   ├── Button.tsx           # Кнопка (primary/secondary/ghost/success/danger)
│   ├── Card.tsx             # Карточка с тенью
│   ├── CircularProgress.tsx # Круговой прогресс
│   ├── ProgressBar.tsx      # Линейный прогресс (динамические цвета)
│   ├── GoalCard.tsx         # Карточка цели (обычная/компактная)
│   ├── ContributionItem.tsx # Элемент накопления
│   └── EmptyState.tsx       # Пустое состояние
├── screens/           # Экраны приложения
│   ├── HomeScreen.tsx         # Главная с обзором (NEW)
│   ├── GoalsScreen.tsx        # Список целей (упрощённый)
│   ├── ProfileScreen.tsx      # Профиль + настройки (NEW)
│   ├── GoalDetailScreen.tsx   # Детали цели
│   ├── SafeDetailScreen.tsx   # Сейф для излишков (NEW)
│   ├── ShiftFlowScreen.tsx    # Модальный поток смен (NEW)
│   ├── HistoryScreen.tsx      # История накоплений
│   └── AddGoalModal.tsx       # Добавление цели
├── navigation/        # Навигация
│   ├── RootStackNavigator.tsx  # Корневой стек
│   ├── MainTabNavigator.tsx    # 3 вкладки
│   ├── HomeStackNavigator.tsx  # Стек главной (NEW)
│   ├── GoalsStackNavigator.tsx # Стек целей
│   └── ProfileStackNavigator.tsx # Стек профиля (NEW)
├── hooks/            # Хуки
│   ├── useTheme.ts   # Хук для работы с темой
│   └── useScreenOptions.ts # Опции навигации
├── lib/              # Утилиты и хранилище
│   ├── storage.ts    # AsyncStorage операции
│   └── types.ts      # TypeScript типы
└── constants/        # Тема и константы
    └── theme.ts      # Цветовая палитра и стили (Colors, Typography, Spacing, Shadows)
```

## Дизайн v3 (Calm Neo-Mint)

### Светлая тема
- Фон: #F7F8FA (root), #FFFFFF (card)
- Primary: #3B82F6 (синий)
- Accent: #10B981 (изумрудный)
- Success: #22C55E (зелёный)
- Warning: #F59E0B (оранжевый)
- Error: #EF4444 (красный)

### Тёмная тема
- Фон: #0D1117 (root), #161B22 (card)
- Primary: #58A6FF (голубой)
- Accent: #3FB950 (зелёный)
- Границы: rgba(48,54,61,0.5)

### UI особенности
- Минималистичные карточки с мягкими тенями
- Плавные анимации (spring)
- Адаптивный дизайн для разных экранов
- Быстрые суммы: 500, 1000, 2000, 3000, 5000 руб.

## Запуск
```bash
npm run all:dev
```

## Последние изменения

### 2025-12-05: Критические улучшения UX
- **Календарь для смен**: Полноценный выбор даты через react-native-calendars с русской локализацией
- **Валидация дубликатов смен**: На уровне storage - разрешена только 1 дневная + 1 ночная смена в день
- **Валидация названий целей**: Нельзя создать цели с одинаковыми названиями  
- **Умное распределение излишков**: При завершении смены/пополнении цели излишек автоматически идёт в Сейф с уведомлением
- **Расчёт дней до цели**: На основе averageDailyEarning из настроек (обновляется автоматически)
- **Улучшенная статистика**: Недельный/месячный заработок на главной, виджеты активных смен и Сейфа
- **Унифицированный дизайн**: Консистентные стили на всех вкладках

### 2025-12-05: FULL UI REDESIGN v3 - Calm Neo-Mint:
  - Новая светлая/тёмная цветовая схема
  - Упрощённая навигация: 3 вкладки вместо 4
  - Новый HomeScreen с dashboard обзором
  - Новый ProfileScreen (объединяет настройки и профиль)
  - Новый SafeDetailScreen для управления сейфом
  - Новый ShiftFlowScreen как модальный поток для смен
  - Обновлены все базовые компоненты с поддержкой темы
  - GoalCard с компактным режимом
  - Быстрые кнопки сумм для пополнения
  - Улучшенная типизация навигации

## Архитектура навигации
```
RootStackNavigator
├── Main (MainTabNavigator)
│   ├── HomeTab (HomeStackNavigator)
│   │   └── Home
│   ├── GoalsTab (GoalsStackNavigator)
│   │   └── Goals
│   └── ProfileTab (ProfileStackNavigator)
│       └── Profile
├── AddGoal (modal)
├── AddContribution (modal)
├── GoalDetail
├── SafeDetail
├── ShiftFlow (modal)
└── ArchivedGoals
```

## Статус функционала
### Реализовано:
- Светлая/тёмная тема с плавным переключением
- Dashboard на главной (общий прогресс, быстрые действия)
- Упрощённый список целей с FAB
- Профиль с настройками и средним заработком
- Сейф: пополнение, распределение на цели, история
- Смены: планирование, активные с прогрессом, завершение с выбором цели
- Быстрое пополнение целей из модального окна
- Архив достигнутых целей

### В планах:
- Уведомления о достижении целей
- Экспорт данных
- Синхронизация через облако
